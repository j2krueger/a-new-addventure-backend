openapi: 3.1.0
info:
  title: A New Addventure
  description:
    "A collaborative fiction site that allows users to write stories with\
    \ multiple branches, and add branches to existing stories written by others."
  version: 1.0.0
servers:
  - url: /
paths:
  /register:
    summary: GET/POST registration
    post:
      tags:
        - User
      summary: Register a new user
      description:
        "Register a new user by posting a new userName, an email address,\
        \ and a password. Check for unique userName, send verification email, and\
        \ store password."
      operationId: register_user
      requestBody:
        description: Submit a request to register a user
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Register"
            example:
              {
                "userName": "Freddy",
                "email": "Freddy@example.com",
                "password": "s33krit!",
              }
      responses:
        "201":
          description: "If the registration is successful, return the users private profile information to indicate success."
          content:
            application/json:
              example:
                {
                  "userId": "66845f61c806ebe5276df8db",
                  "userName": "Freddy",
                  "email": "Freddy@example.com",
                  "bio": "I haven't decided what to put in my bio yet.",
                  "publishEmail": false,
                }
        "400":
          description: "If any of the fields are missing, return an error."
          content:
            application/json:
              examples:
                missingPassword:
                  value: { "error": "Missing password." }
                missingUserName:
                  value: { "error": "Missing userName." }
                missingEmail:
                  value: { "error": "Missing email." }
        "409":
          description: "Username or Email are already in use."
          content:
            application/json:
              examples:
                duplicateUserName:
                  value: { "error": "Username already in use." }
                duplicateEmail:
                  value: { "error": "Email already in use." }
        default:
          description: Default error sample response
  /login:
    summary: GET/POST login
    post:
      tags:
        - User
      summary: Login user
      description:
        "Post the name and password entered by the user, name may be either a userName or an email,\
        \ userName checked first. If the name matches a user and the password is correct for that user,\
        \ log them in."
      operationId: login_user
      requestBody:
        description: Submit a request to login
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Login"
            example: { "name": "Freddy", "password": "s33krit!" }
      responses:
        "200":
          description: "If the login is successful, return the users private profile information to indicate success."
          content:
            application/json:
              example:
                {
                  "userId": "667afb5feb94737bf4556b7e",
                  "userName": "Hank R. Chief",
                  "email": "Hank@example.com",
                  "bio": "I haven't decided what to put in my bio yet.",
                  "publishEmail": false,
                }
        "400":
          description: "Missing field."
          content:
            application/json:
              examples:
                missingName:
                  value: { "error": "Missing name." }
                missingPassword:
                  value: { "error": "Missing password." }
        "401":
          description: "Login failed."
          content:
            application/json:
              example: { "error": "Incorrect name or password." }
        default:
          description: Default error sample response
  /logout:
    summary: POST logout
    post:
      tags:
        - User
      summary: Logout the logged in user.
      description:
        "Logout the logged in user. Posted by a button on the users profile\
        \ page, or from the user menu."
      operationId: logout_user
      responses:
        "200":
          description:
            "Logout should always be successful. If user was logged in\
            \ before request, the cookie will indicate the user to log out. If user\
            \ was not logged in before request, user will still not be logged in,\
            \ so we'll call that a success condition too."
          content:
            application/json:
              example: { "message": "Logout successful." }
        default:
          description: Default error sample response
  /profile:
    summary: GET/PUT logged in user's profile
    get:
      tags:
        - User
      summary: Get user's profile.
      description:
        "If a user is logged in, get that user's settings from the server,\
        \ and show them on the page. If no user is logged in, check localStorage for\
        \ basic settings (light/dark mode, blocked tags) otherwise use default basic\
        \ settings. Can be used to change settings."
      operationId: get_profile_page
      responses:
        "200":
          description: "Returns the private profile information of the logged in user."
          content:
            application/json:
              example:
                {
                  "userId": "668490250029a28118a8d1be",
                  "userName": "Freddy",
                  "email": "Freddy@example.com",
                  "admin": true,
                  "moderator": false,
                  "bio": "I have REALLY decided what to put in my bio yet.",
                  "publishEmail": true,
                  "darkMode": true,
                  "publishedEntries":
                    [
                      {
                        "storyId": "6695b2573550c66db1ab9106",
                        "entryId": "66a7fd2095206fecbb52c189",
                        "storyTitle": "In the beginning...",
                        "entryTitle": "Lerrald and Vred sought the Cartesian Bear",
                        "authorName": "Freddy",
                        "previousEntry": "6695b2573550c66db1ab9106",
                        "likes": 0,
                      },
                      {
                        "storyId": "6695b2573550c66db1ab9106",
                        "entryId": "6695b2573550c66db1ab9106",
                        "storyTitle": "In the beginning...",
                        "entryTitle": null,
                        "authorName": "Freddy",
                        "previousEntry": null,
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "668820191cb99dfdc244c23c",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the first",
                        "authorName": "Freddy",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "6688142fb004b799a5a29d03",
                        "storyTitle": "Random Title",
                        "entryTitle": null,
                        "authorName": "Freddy",
                        "previousEntry": null,
                        "likes": 0,
                      },
                    ],
                  "followedAuthors":
                    [
                      {
                        "userName": "apmanager",
                        "userId": "667b294248b8805d71a96a03",
                      },
                      {
                        "userName": "BlackLagoon",
                        "userId": "668ee18ae1dcd980cf0739c2",
                      },
                      {
                        "userName": "FreddyJupiter",
                        "userId": "668ee1cfe1dcd980cf0739db",
                      },
                      {
                        "userName": "FreddyMercury",
                        "userId": "668ee198e1dcd980cf0739c7",
                      },
                      {
                        "userName": "FreddyQuaoar",
                        "userId": "668ee23ce1dcd980cf0739f9",
                      },
                    ],
                  "likedEntries":
                    [
                      {
                        "storyId": "66a5a2ab375bbb2298ff7420",
                        "entryId": "66a5a2ab375bbb2298ff7420",
                        "storyTitle": "7th newest ",
                        "entryTitle": null,
                        "authorName": "apmanager",
                        "authorId": "667b294248b8805d71a96a03",
                        "previousEntry": null,
                        "likes": 0,
                      },
                    ],
                  "bookmarkedEntries":
                    [
                      {
                        "storyId": "6695b2573550c66db1ab9106",
                        "entryId": "66a7fd2095206fecbb52c189",
                        "storyTitle": "In the beginning...",
                        "entryTitle": "Lerrald and Vred sought the Cartesian Bear",
                        "authorName": "Freddy",
                        "authorId": "668490250029a28118a8d1be",
                        "previousEntry": "6695b2573550c66db1ab9106",
                      },
                    ],
                }
        "401":
          description: "If no user is logged in, return an error"
          content:
            application/json:
              example: { "error": "No user logged in." }
        default:
          description: Default error sample response
    put:
      tags:
        - User
      summary: Post changes to user's profile.
      description: "If a user is logged in, put the changed settings to the server."
      operationId: put_profile
      requestBody:
        description: "Submit a request to change some settings."
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Settings"
            example:
              {
                "publishEmail": true,
                "bio": "This is a new bio.",
                "darkMode": false,
              }
      responses:
        "200":
          description: "Return the user's private profile data"
          content:
            application/json:
              example:
                {
                  "userId": "668490250029a28118a8d1be",
                  "userName": "Freddy",
                  "email": "Freddy@example.com",
                  "bio": "I HAVE decided what to put in my bio yet.",
                  "publishEmail": true,
                  "darkMode": false,
                  "publishedEntries":
                    [
                      {
                        "entryId": "6685cf32fb208efa4de7dfab",
                        "storyTitle": "Story Title",
                        "entryTitle": null,
                      },
                      {
                        "entryId": "6685d031715453a8be27589b",
                        "storyTitle": "Super Good Title",
                        "entryTitle": null,
                      },
                      {
                        "entryId": "6688142fb004b799a5a29d03",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the zeroeth",
                      },
                      {
                        "entryId": "668820191cb99dfdc244c23c",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the first",
                      },
                      {
                        "entryId": "668857a03f120ae7785257d4",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the zeroeth",
                      },
                    ],
                }
        "400":
          description: Bad request
          content:
            application/json:
              example: { error: "Invalid request." }
        default:
          description: Default error sample response
  /user:
    summary: GET a list of users
    get:
      tags:
        - User
        - Search
      summary: "Get a list of users, sorted alphabetically."
      description:
        "Get a list of users, in publicInfo format, sorted alphabetically. If there's a query string, only return the users whose userNames\
        \ match that query string."
      operationId: get_users
      parameters:
        - in: query
          name: regex
          schema:
            type: string
          description: "If present, only returns users whose userName matches the regex, case sensitive unless i is set to a non-empty value."
        - in: query
          name: i
          schema:
            type: string
          description: "If set to a non-empty value, regex match is done case insensitively. Ignored if regex is not set."
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
          description: "Returns the indicated page number of the result list. If not set, is equivalent to setting page=1"
      responses:
        "200":
          description: "List of users found."
          content:
            application/json:
              example:
                [
                  {
                    "userId": "668ee1dae1dcd980cf0739e0",
                    "userName": "FreddySaturn",
                    "email": "",
                    "bio": "I haven't decided what to put in my bio yet.",
                    "publishedEntries": [],
                  },
                  {
                    "userId": "668ee27de1dcd980cf073a08",
                    "userName": "FreddySedna",
                    "email": "",
                    "bio": "I haven't decided what to put in my bio yet.",
                    "publishedEntries": [],
                  },
                  {
                    "userId": "668ee31ae1dcd980cf073a17",
                    "userName": "FreddyTitan",
                    "email": "",
                    "bio": "I haven't decided what to put in my bio yet.",
                    "publishedEntries": [],
                  },
                ]
        "404":
          description: "No users matching the search string found."
          content:
            application/json:
              example: { error: "No matching users found." }
        default:
          description: Default error sample response
  /user/{userId}:
    summary: GET a user's public profile
    get:
      tags:
        - User
      summary: Get a user's public profile.
      description:
        "Get a webpage showing the specified user's public profile, including\
        \ userName, bio, email if user has decided to make that public, links to entries\
        \ and comments, possibly other stuff we think of later."
      operationId: get_public_profile
      parameters:
        - name: userId
          in: path
          description: the ID of the user
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: "Successfully retrieved user profile."
          content:
            application/json:
              example:
                {
                  "userId": "668490250029a28118a8d1be",
                  "userName": "Freddy",
                  "email": "Freddy@example.com",
                  "bio": "I HAVE decided what to put in my bio yet.",
                  "publishedEntries":
                    [
                      {
                        "entryId": "6685cf32fb208efa4de7dfab",
                        "storyTitle": "Story Title",
                        "entryTitle": null,
                      },
                      {
                        "entryId": "6685d031715453a8be27589b",
                        "storyTitle": "Super Good Title",
                        "entryTitle": null,
                      },
                      {
                        "entryId": "6688142fb004b799a5a29d03",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the zeroeth",
                      },
                      {
                        "entryId": "668820191cb99dfdc244c23c",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the first",
                      },
                      {
                        "entryId": "668857a03f120ae7785257d4",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the zeroeth",
                      },
                    ],
                }
        "404":
          description: "User not found."
          content:
            application/json:
              example: { "error": "There is no user with that user ID." }
        default:
          description: Default error sample response
  /user/{userId}/follow:
    summary: Allows a logged-in user to follow another author
    post:
      tags:
        - User
      summary: Follow another user
      description: "If a user is logged in, posting to this route causes the logged in user to follow the user whose ID is in the path parameter."
      operationId: follow_user
      parameters:
        - name: userId
          in: path
          description: the ID of the user
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: "Successfully followed another user."
          content:
            application/json:
              example: { "message": "Follow successful." }
        "400":
          description: "Not a valid userId format"
          content:
            application/json:
              example: { "error": "That is not a properly formatted userId." }
        "404":
          description: "User not found."
          content:
            application/json:
              example: { "error": "There is no user with that user ID." }
        "409":
          description: "You can only follow a given user once."
          content:
            application/json:
              examples:
                duplicate:
                  value: { "error": "You are already following that user." }
                circular:
                  value:
                    {
                      "error": "Following yourself means you're going around in circles.",
                    }
        default:
          description: Default error sample response
    delete:
      tags:
        - User
      summary: Unfollow another user
      description: "If a user is logged in, deleteing this route causes the logged in user to unfollow the user whose ID is in the path parameter."
      operationId: unfollow_user
      parameters:
        - name: userId
          in: path
          description: the ID of the user
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: "Successfully unfollowed another user."
          content:
            application/json:
              example: { "message": "Author successfully unfollowed." }
        "400":
          description: "Not a valid userId format"
          content:
            application/json:
              example: { "error": "That is not a properly formatted userId." }
        "404":
          description: "User not found or not followed."
          content:
            application/json:
              example: { "error": "No follow to remove." }
        default:
          description: Default error sample response
  /entry:
    summary: GET/POST entries
    get:
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          description: "The page number of results the user is requesting. Absence is equivalent to 'page=1'"
        - in: query
          name: regex
          schema:
            type: string
          description: "A regular expression, only entries that match regexp in one of the fields specified in 'fields' will be returned"
        - in: query
          name: fields
          schema:
            type: string
          description:
            "a string containing letters specifying fields in which to look for matches of 'regexp' with the following\
            \ correspondence: s: storyTitle, e: entryTitle, a: authorName, b: bodyText. If 'fields' is not specified,\
            \ it defaults to 'seab'"
        - in: query
          name: order
          schema:
            type: string
          description:
            "a string specifying the sort order of the results. Each of the following letters specifies a field: s:storyTitle, e:entryTitle,\
            \ a:authorName, l:likes, c:createDate, b:bodyText. Lowercase letters specify ascending order, capital letters specify decending order.\
            \ Fields specified earlier take priority over fields specified later, e.g. if 'order' is 'sE', then entries will be sorted in alphabetical\
            \ order by storyTitle, and entries with the same storyTitle will be sorted in reverse alphabetical order by entryTitle. Text field sorts\
            \ are case insensitive. If 'order' is not specified, it defaults to 'C' (newest first)."
        - in: query
          name: storiesOnly
          schema:
            type: boolean
          description: "If true, only returns stories, i.e. entries that have storyId equal to entryId and previousEntry equal to null"
      tags:
        - Entry
      summary: GET a list of recent entries
      description: "Gets a list of [constants.entriesPerPage] recent entries, newest first. Get more by setting query string to 'page=2', etc."
      operationId: get_entry_list
      responses:
        "200":
          description: "Successfully found entries."
          content:
            application/json:
              example:
                [
                  {
                    "storyId": "6688142fb004b799a5a29d03",
                    "entryId": "6688142fb004b799a5a29d03",
                    "storyTitle": "Random Title",
                    "entryTitle": null,
                    "authorName": "Freddy",
                    "authorId": "668490250029a28118a8d1be",
                    "previousEntry": null,
                    "likes": 0,
                    "likedByUser": false,
                  },
                  {
                    "storyId": "6688142fb004b799a5a29d03",
                    "entryId": "668820191cb99dfdc244c23c",
                    "storyTitle": "Random Title",
                    "entryTitle": "Chapter the first",
                    "authorName": "Freddy",
                    "authorId": "668490250029a28118a8d1be",
                    "previousEntry": "6688142fb004b799a5a29d03",
                    "likes": 0,
                    "likedByUser": false,
                  },
                  {
                    "storyId": "66a5a2ab375bbb2298ff7420",
                    "entryId": "66a5a2ab375bbb2298ff7420",
                    "storyTitle": "7th newest ",
                    "entryTitle": null,
                    "authorName": "apmanager",
                    "authorId": "667b294248b8805d71a96a03",
                    "previousEntry": null,
                    "likes": 1,
                    "likedByUser": true,
                  },
                ]
        default:
          description: Default error sample response
    post:
      tags:
        - Entry
        - Story
      summary: Post a new story
      description: "Post the story title, entry title, and text of an entry to start a new story."
      operationId: post_story
      requestBody:
        description: "Post a new story."
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NewStory"
            example:
              {
                "storyTitle": "Random Title",
                "bodyText": "Genji no monogatari",
              }
      responses:
        "201":
          description: "Successfully created entry."
          content:
            application/json:
              example:
                {
                  "storyId": "66ba234d47197cfda2cca67f",
                  "entryId": "66ba234d47197cfda2cca67f",
                  "storyTitle": "In the beginnning...",
                  "entryTitle": null,
                  "authorName": "Freddy",
                  "authorId": "668490250029a28118a8d1be",
                  "bodyText": "testkurmdlqazsvnepyhs",
                  "previousEntry": null,
                  "likes": 0,
                  "createDate": "2024-08-12T14:59:25.128Z",
                }
        "400":
          description: "Bad request."
          content:
            application/json:
              examples:
                missingStoryTitle:
                  value: { "error": "Missing story title." }
                missingBodyText:
                  value: { "error": "Missing story text." }
        default:
          description: Default error sample response
  /entry/{entryId}:
    summary: GET/POST/PUT/DELETE a particular entry
    get:
      tags:
        - Entry
      summary: GET a particular entry by ID
      description: "Gets entry data, and an array named continuationEntries containing entryIds and entry titles from continuation entries."
      operationId: get_entry_by_id
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: "Entry found"
          content:
            application/json:
              example:
                {
                  "entryId": "6688142fb004b799a5a29d03",
                  "authorName": "Freddy",
                  "authorId": "668490250029a28118a8d1be",
                  "entryTitle": null,
                  "storyTitle": "Random Title",
                  "bodyText": "Genji no monogatari",
                  "previousEntry": null,
                  "flagId": null,
                  "likes": 0,
                  "likedByUser": false,
                  "createDate": "2024-07-05T15:41:35.510Z",
                  "storyId": "6688142fb004b799a5a29d03",
                  "continuationEntries":
                    [
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "668820191cb99dfdc244c23c",
                        "storyTitle": "Random Title",
                        "entryTitle": "Chapter the first",
                        "authorName": "Freddy",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "668c4771e0989ccd9cd6ec8a",
                        "storyTitle": "Random Title",
                        "entryTitle": "adding to this entries list of sub entries",
                        "authorName": "apmanager",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "668c47c3e0989ccd9cd6eca8",
                        "storyTitle": "Random Title",
                        "entryTitle": "adding another to list of entries",
                        "authorName": "apmanager",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "668c47eae0989ccd9cd6ecc8",
                        "storyTitle": "Random Title",
                        "entryTitle": "today is today",
                        "authorName": "apmanager",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "668d51e61be56166aaaa6cc2",
                        "storyTitle": "Random Title",
                        "entryTitle": "Suddenly, a wild accountant appears!",
                        "authorName": "Freddy",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                      {
                        "storyId": "6688142fb004b799a5a29d03",
                        "entryId": "66a5a060375bbb2298ff7353",
                        "storyTitle": "Random Title",
                        "entryTitle": "sixth title",
                        "authorName": "apmanager",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                      },
                    ],
                }
        "400":
          description: "userId not well formed"
          content:
            application/json:
              example: { "error": "That is not a properly formatted userId." }
        "404":
          description: "userId not found"
          content:
            application/json:
              example: { "error": "There is no user with that userId." }
        default:
          description: Default error sample response
    post:
      tags:
        - Entry
        - Story
      summary: Post a new story
      description: "Post the entry title and text of an entry to continue a story."
      operationId: continue_story
      requestBody:
        description: "Continue a story."
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ContinueStory"
            example:
              {
                "entryTitle": "Random Title",
                "bodyText": "Genji no monogatari",
              }
      responses:
        "201":
          description: "Successfully created entry."
          content:
            application/json:
              example:
                {
                  "authorName": "Freddy",
                  "entryTitle": "Chapter the zeroeth",
                  "storyTitle": "Random Title",
                  "bodyText": "Genji no monogatari",
                  "previousEntry": null,
                  "flagId": null,
                  "likes": 0,
                  "_id": "6688142fb004b799a5a29d03",
                  "createDate": "2024-07-05T15:41:35.510Z",
                  "storyId": "6688142fb004b799a5a29d03",
                  "__v": 0,
                }
        "400":
          description: "Bad request."
          content:
            application/json:
              examples:
                missingStoryTitle:
                  value: { "error": "Missing entry title." }
                missingBodyText:
                  value: { "error": "Missing story text." }
        default:
          description: Default error sample response
  /entry/{entryId}/like:
    summary: POST or DELETE a like to an entry
    post:
      tags:
        - Entry
      summary: Like an entry
      description: "Like an entry. You cannot like your own entries, or like an entry multiple times."
      operationId: like_entry
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Like successfully posted.
          content:
            application/json:
              example: { "message": "Entry liked." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted entryId." }
        "404":
          description: entryId not found."
          content:
            application/json:
              example: { "error": "There is no entry with that entryId." }
        "409":
          description: Conflict
          content:
            application/json:
              examples:
                duplicateLike:
                  value: { "error": "You have already liked that entry." }
                likeOwnEntry:
                  value: { "error": "You cannot like your own entries." }
        default:
          description: Default error sample response
    delete:
      tags:
        - Entry
      summary: Remove a like from an entry
      description: "Remove a like from an entry."
      operationId: unlike_entry
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Like successfully removed.
          content:
            application/json:
              example: { "message": "Like successfully removed." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted entryId." }
        "404":
          description: entryId not found."
          content:
            application/json:
              examples:
                notLiked:
                  value: { error: "You have not liked that entry." }
                entryIdNotFound:
                  value: { "error": "There is no entry with that entryId." }
        default:
          description: Default error sample response
  /entry/{entryId}/flag:
    summary: POST a flag for review on the entry
    post:
      tags:
        - Entry
        - Flag
      summary: Flag an entry for review
      description: "Post a flag for review, to be entered into a moderation queue. Must include reason for flagging."
      operationId: flag_entry
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      requestBody:
        description: Flag an entry
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Flag"
            example: { "reason": "Spam" }
      responses:
        "200":
          description: Entry successfully flagged.
          content:
            application/json:
              example: { "message": "Entry successfully flagged." }
        "400":
          description: Bad request.
          content:
            application/json:
              examples:
                noReason:
                  value: { "error": "Flagging an entry needs a reason." }
                badEntryId:
                  value:
                    { "error": "That is not a properly formatted entryId." }
        "404":
          description: Entry not found.
          content:
            application/json:
              example: { "error": "There is no entry with that entryId." }
        default:
          description: Default error sample response
  /entry/{entryId}/bookmark:
    summary: POST or DELETE bookmarks
    post:
      tags:
        - Entry
        - Bookmark
      summary: Bookmark a page
      description: If there is a logged in user, set a bookmark for that user on that entry.
      operationId: bookmark_entry
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Successfully created bookmark.
          content:
            application/json:
              example: { "message": "Entry bookmarked." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted entryId." }
        "404":
          description: Entry not found
          content:
            application/json:
              example: { "error": "There is no entry with that entryId." }
        "409":
          description: User has already bookmarked that entry.
          content:
            application/json:
              example: { "error": "You have already liked that bookmark." }
        default:
          description: Default error sample response
    delete:
      tags:
        - Entry
        - Bookmark
      summary: Unbookmark a page
      description: If there is a logged in user that has bookmarked the given entry, remove the bookmark.
      operationId: unbookmark_entry
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Successfully deleted bookmark.
          content:
            application/json:
              example: { message: "Bookmark successfully deleted." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted entryId." }
        "404":
          description: Entry not found
          content:
            application/json:
              examples:
                notBookmarked:
                  value: { "error": "You don't have that entry bookmarked." }
                missingEntry:
                  value: { "error": "There is no entry with that entryId." }
        default:
          description: Default error sample response
  /entry/{entryId}/keyword/{keyword}:
    summary: GET/POST/DELETE keywords
    get:
      tags:
        - Entry
        - Keyword
      summary: Get list of keywords on entry.
      description:
        "Gets a list of the keywords applied to the entry. Special keywords\
        \ first, then non-special inherited keywords, then non-special non-inherited\
        \ keywords."
      operationId: get_keywords
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
        - name: keyword
          in: path
          description: a keyword
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
    post:
      tags:
        - Entry
        - Keyword
      summary: Post new keywords to an entry
      description:
        "Posts one or more keywords to be applied to an existing entry.\
        \ Admins, mods, and creating author get their new keywords automatically applied,\
        \ anyone else gets their keywords submitted to a mod queue."
      operationId: post_new_keywords
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
        - name: keyword
          in: path
          description: a keyword
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
    delete:
      tags:
        - Entry
        - Keyword
      summary: Delete keywords from an entry.
      description:
        "If given keywords are not inherited, admins, mods, and the entry\
        \ creator get the keyword deleted immediately, anyone else gets keyword deletion\
        \ request submitted to mod queue."
      operationId: delete_keywords
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
        - name: keyword
          in: path
          description: a keyword
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
  /entry/{entryId}/comment:
    summary: GET/POST comments on entry
    get:
      tags:
        - Entry
        - Comment
      summary: Get comments posted to an entry
      description:
        Get a list of the comments that have been posted to an entry. Each
        comment entry will have the userName of the user who posted it attatched.
      operationId: get_comments
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
    post:
      tags:
        - Entry
        - Comment
      summary: Post a new comment.
      description: Post a new comment to an entry. Any logged in user.
      operationId: post_comment
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
  /entry/{entryId}/comment/{commentId}:
    summary: PUT/DELETE a comment
    put:
      tags:
        - Entry
        - Comment
      summary: Edit a comment.
      description: Edit a comment. Admin/mod/comment creator only.
      operationId: edit_comment
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
        - name: commentId
          in: path
          description: the ID of the comment
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
    delete:
      tags:
        - Entry
        - Comment
      summary: Delete a comment.
      description: Delete a comment. Admin/mod/comment creator only.
      operationId: delete_comment
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
        - name: commentId
          in: path
          description: the ID of the comment
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
  /entry/{entryId}/comment/{commentId}/flag:
    summary: POST a flag for review on a comment
    post:
      tags:
        - Entry
        - Comment
        - Flag
      summary: Post a flag for review on a comment
      description: "Post a flag for review on a comment, inserted into mod queue"
      operationId: flag_comment
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
        - name: commentId
          in: path
          description: the ID of the comment
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        default:
          description: Default error sample response
  /message:
    summary: Post messages to the site admins
    post:
      tags:
        - Message
      summary: POST messages to the site admins
      description: "POST a message to the site admins."
      operationId: post_message
      requestBody:
        description:
          "The body JSON must include messageText, and optionally any or all of name, email, and useLoginInfo. If useLoginInfo is set to true, and the\
          \ submitter of the form is a logged in user, the name and email of the message are set to the user's userName and email, and the message is\
          \ marked as verified when it is added to the database. If useLoginInfo is not set, but the name and email match the userName and email of a\
          \ logged in user, then the email is marked as verified. If useLoginInfo is set to true and the submitter is not logged in, they are redirected\
          \ to /login. If useLoginInfo is set to false, or not included, and either there is no logged in user, or the name or email provided do not match\
          \ the username and email of the logged in user, then name and email will be used to set their respective submitted values (if present), and\
          \ the message will not be marked as verified."
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Message"
            examples:
              nameAndEmail:
                value:
                  {
                    "name": "Freddy",
                    "email": "Freddy@example.com",
                    "messageText": "This is an unverified message to the admins.",
                  }
              anonymous:
                value: { "messageText": "Eye think ewe knead a spell checker." }
              loggedIn:
                value:
                  {
                    "useLoginInfo": true,
                    "messageText": "This is a verified message to the admins.",
                  }
      responses:
        "200":
          description: "Successfully created message"
          content:
            application/json:
              example: { "message": "Message sent." }
        "400":
          description: "Bad request."
          content:
            application/json:
              example: { "error": "Message text is missing." }
        default:
          description: Default error sample response
  /admin/message:
    summary: Admin route to read messages POSTed to /message
    get:
      tags:
        - Message
        - Admin
      summary: GET messages
      description: "If there is a logged in user that is an admin, return a list of messages. Otherwise, redirect to /login"
      operationId: get_message
      parameters:
        - in: query
          name: unread
          schema:
            type: boolean
          description: "If unread is set to true, the GET will only return messages that have read set to false, otherwise it will return all messages."
      responses:
        "200":
          description: "list of messages found"
          content:
            application/json:
              example:
                [
                  {
                    "_id": "669fdd90d88a3ce68dde514f",
                    "name": "Anonymous",
                    "email": "Anonymous@example.com",
                    "messageText": "This should NOT be a verified message",
                    "verified": false,
                    "read": false,
                    "__v": 0,
                    "createDate": "2024-07-23T19:30:14.089Z",
                  },
                  {
                    "_id": "66a00443827cfd41d2557be0",
                    "name": "Anonymous",
                    "email": "Anonymous@example.com",
                    "messageText": "This should NOT be a verified message",
                    "verified": false,
                    "read": false,
                    "__v": 0,
                    "createDate": "2024-07-23T19:30:14.089Z",
                  },
                  {
                    "_id": "66a004c0e6e6a8e16fca8210",
                    "name": "Anonymous",
                    "email": "No email",
                    "messageText": "This is an anonymous message to the admins",
                    "verified": false,
                    "read": false,
                    "createDate": "2024-07-23T19:30:08.007Z",
                    "__v": 0,
                  },
                ]
        default:
          description: Default error sample response
  /admin/message/{messageId}:
    summary: Admin route to work with individual messages POSTed to /message
    put:
      tags:
        - Message
        - Admin
      summary: Mark a particular message as read or unread
      description: If there is a logged in user that is an admin, allow them to mark the message as read or unread.
      operationId: mark_message_read
      parameters:
        - name: messageId
          in: path
          description: the ID of the message
          required: true
          style: simple
          explode: false
          schema: {}
      requestBody:
        description: Submit a request to mark the message as read or unread
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateMessage"
            example: { "read": true }
      responses:
        "200":
          description: Successfully updated messages.
          content:
            application/json:
              example:
                {
                  "_id": "669fdb11d88a3ce68dde514c",
                  "name": "Freddy",
                  "email": "Freddy@example.com",
                  "messageText": "This should be a verified message",
                  "verified": true,
                  "read": true,
                  "__v": 0,
                  "createDate": "2024-07-24T19:21:26.156Z",
                }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "Invalid request." }
        "404":
          description: MessageId not found."
          content:
            application/json:
              example: { "error": "There is no message with that messageId." }
    delete:
      tags:
        - Message
        - Admin
      summary: Delete a message
      description: If there is a logged in user that is an admin, allow them to delete the message.
      operationId: delete_message
      parameters:
        - name: messageId
          in: path
          description: the ID of the message
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "204":
          description: Successfully deleted message.
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "Invalid request." }
        "404":
          description: MessageId not found."
          content:
            application/json:
              example: { "error": "There is no message with that messageId." }
        default:
          description: Default error sample response
  /admin/flag:
    summary: Return a list of flags
    get:
      tags:
        - Flag
        - Admin
      summary: Get a list of flags
      description: "Get a list of flags"
      operationId: get_flags
      responses:
        "200":
          description: Flags successfully returned.
          content:
            application/json:
              example:
                [
                  {
                    "_id": "66aad3654c90731489adad4e",
                    "user":
                      {
                        "_id": "668490250029a28118a8d1be",
                        "userName": "Freddy",
                        "email": "Freddy@example.com",
                        "passwordHash": "$2b$10$UzF100wv.GI8Ba6nEqYvSOSnYW17HyLuLup5uSyg1knoA/aMSADsi",
                        "admin": true,
                        "moderator": false,
                        "bio": "I have REALLY decided what to put in my bio yet.",
                        "publishEmail": true,
                        "darkMode": true,
                        "__v": 0,
                        "id": "668490250029a28118a8d1be",
                      },
                    "entry":
                      {
                        "_id": "668892f10371e6c253583148",
                        "authorName": "apmanager",
                        "entryTitle": "dddddddddddd",
                        "bodyText": "dddddddddddddddddd",
                        "choiceText": "dddddd",
                        "previousEntry": "66885d8e6715f290d4ce03a9",
                        "createDate": "2024-07-06T00:42:25.059Z",
                        "storyId": "66885d8e6715f290d4ce03a9",
                        "storyTitle": "Random Title",
                        "__v": 0,
                        "id": "668892f10371e6c253583148",
                      },
                    "reason": "This author has clearly misspelled 'When in the course of human events'",
                    "createDate": "2024-08-01T17:38:48.795Z",
                    "__v": 0,
                  },
                ]
  /admin/flag/{flagId}:
    summary: Delete a flag
    delete:
      tags:
        - Admin
        - Flag
      summary: Delete a flag
      description: "Delete a flag."
      operationId: delete_flag
      parameters:
        - name: flagId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Successfully deleted flag.
          content:
            application/json:
              example: { "message": "Flag successfully deleted." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted flagId." }
        "404":
          description: Flag not found.
          content:
            application/json:
              example: { "error": "There is no flag with that flagId." }
        default:
          description: Default error sample response
  /admin/entry/{entryId}:
    summary: Delete an entry
    delete:
      tags:
        - Admin
        - Entry
      summary: Delete an entry
      description: "Delete an entry."
      operationId: delete_entry
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Successfully deleted entry.
          content:
            application/json:
              example: { "message": "Entry successfully deleted." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted entryId." }
        "404":
          description: Entry not found.
          content:
            application/json:
              example: { "error": "There is no entry with that entryId." }
        default:
          description: Default error sample response
  /admin/user/{userId}/lock:
    summary: Lock a user
    post:
      tags:
        - Admin
        - User
      summary: Lock a user
      description: Lock a user
      operationId: lock_user
      parameters:
        - name: userId
          in: path
          description: the ID of the user
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Successfully locked user.
          content:
            application/json:
              example: { "message": "User successfully locked." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted userId." }
        "404":
          description: Entry not found.
          content:
            application/json:
              example: { "error": "There is no user with that userId." }
        "409":
          description: User already locked."
          content:
            application/json:
              example: { "error": "That user is already locked." }
        default:
          description: Default error sample response
    delete:
      tags:
        - Admin
        - User
      summary: Unlock a user
      description: Unlock a user
      operationId: unlock_user
      parameters:
        - name: userId
          in: path
          description: the ID of the user
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: Successfully unlocked user.
          content:
            application/json:
              example: { "message": "User successfully unlocked." }
        "400":
          description: Bad request.
          content:
            application/json:
              example: { "error": "That is not a properly formatted userId." }
        "404":
          description: Entry not found.
          content:
            application/json:
              example: { "error": "There is no user with that userId." }
        "409":
          description: User not locked."
          content:
            application/json:
              example: { "error": "That user is not locked." }
        default:
          description: Default error sample response
  /chain/{entryId}:
    summary: GET the entry chain ending at the specified entry
    get:
      tags:
        - Chain
      summary: Get the entry chain ending at the specified entry.
      description:
        "Returns an array of entries with the last one being the entry with the given entryId, and every other entry in the array having the\
        \ entryId equal to previousEntry of the next array entry, and the first array entry being the beginning of the story."
      operationId: get_chain
      parameters:
        - name: entryId
          in: path
          description: the ID of the entry
          required: true
          style: simple
          explode: false
          schema: {}
      responses:
        "200":
          description: "Chain successfully returned."
          content:
            application/json:
              examples:
                fullChain:
                  value:
                    [
                      {
                        "entryId": "6688142fb004b799a5a29d03",
                        "authorName": "Freddy",
                        "authorId": "668490250029a28118a8d1be",
                        "entryTitle": null,
                        "storyTitle": "Random Title",
                        "bodyText": "Genji no monogatari",
                        "previousEntry": null,
                        "likes": 0,
                        "likedByUser": false,
                        "bookmarkedByUser": false,
                        "createDate": "2024-07-05T15:41:35.510Z",
                        "storyId": "6688142fb004b799a5a29d03",
                        "continuationEntries":
                          [
                            {
                              "storyId": "6688142fb004b799a5a29d03",
                              "entryId": "668820191cb99dfdc244c23c",
                              "storyTitle": "Random Title",
                              "entryTitle": "Chapter the first",
                              "authorName": "Freddy",
                              "previousEntry": "6688142fb004b799a5a29d03",
                            },
                            {
                              "storyId": "6688142fb004b799a5a29d03",
                              "entryId": "668c4771e0989ccd9cd6ec8a",
                              "storyTitle": "Random Title",
                              "entryTitle": "adding to this entries list of sub entries",
                              "authorName": "apmanager",
                              "previousEntry": "6688142fb004b799a5a29d03",
                            },
                          ],
                      },
                      {
                        "entryId": "668d51e61be56166aaaa6cc2",
                        "authorName": "Freddy",
                        "authorId": "668490250029a28118a8d1be",
                        "entryTitle": "Suddenly, a wild accountant appears!",
                        "storyTitle": "Random Title",
                        "bodyText": "It throws a bundle of tax forms at our hero, Bob, stunning him! The existential dread is almost enough to keep him from dodging the subsequent thrown calculator, but he manages to roll out of the way in time, and retaliate with a well-swung Swingline stapler!",
                        "previousEntry": "6688142fb004b799a5a29d03",
                        "likes": 0,
                        "likedByUser": false,
                        "bookmarkedByUser": false,
                        "createDate": "2024-07-09T15:06:14.267Z",
                        "storyId": "6688142fb004b799a5a29d03",
                        "continuationEntries": [],
                      },
                    ]
                brokenChain:
                  value:
                    [
                      {
                        "entryId": "66bd0378fd83fe5734584651",
                        "authorName": "testkurmdlqazsvnepyhs0.7645244396758495",
                        "authorId": "66bd0374fd83fe5734584612",
                        "entryTitle": "testkurmdlqazsvnepyhs1",
                        "storyTitle": "testkurmdlqazsvnepyhs",
                        "bodyText": "testkurmdlqazsvnepyhs2",
                        "previousEntry": "66bd0377fd83fe5734584642",
                        "likes": 0,
                        "createDate": "2024-08-14T19:20:24.445Z",
                        "storyId": "66bd0377fd83fe5734584642",
                        "continuationEntries":
                          [
                            {
                              "storyId": "66bd0377fd83fe5734584642",
                              "entryId": "66bd0379fd83fe5734584660",
                              "storyTitle": "testkurmdlqazsvnepyhs",
                              "entryTitle": "testkurmdlqazsvnepyhs1",
                              "authorName": "testkurmdlqazsvnepyhs0.7645244396758495",
                              "previousEntry": "66bd0378fd83fe5734584651",
                            },
                          ],
                      },
                      {
                        "entryId": "66bd0379fd83fe5734584660",
                        "authorName": "testkurmdlqazsvnepyhs0.7645244396758495",
                        "authorId": "66bd0374fd83fe5734584612",
                        "entryTitle": "testkurmdlqazsvnepyhs1",
                        "storyTitle": "testkurmdlqazsvnepyhs",
                        "bodyText": "testkurmdlqazsvnepyhs2",
                        "previousEntry": "66bd0378fd83fe5734584651",
                        "likes": 0,
                        "createDate": "2024-08-14T19:20:25.135Z",
                        "storyId": "66bd0377fd83fe5734584642",
                        "continuationEntries": [],
                      },
                    ]
        "400":
          description: "malformed request."
          content:
            application/json:
              example: { "error": "That is not a properly formatted entryId." }
        "404":
          description: "entryId does not exist."
          content:
            application/json:
              example: { "error": "There is no entry with that entryId." }
        default:
          description: Default error sample response
  /keywords:
    summary: GET a list of defined keywords
    get:
      tags:
        - Keyword
        - Search
      summary: Get a list of defined keywords
      description:
        "Get a list of all used keywords, sorted alphabetically or by use\
        \ count. If a query string is used, return only matching keywords."
      operationId: get_keyword_list
      responses:
        "200":
          description: "Successfully found a list of keywords."
          content:
            application/json:
              examples:
                registered:
                  value:
                    { "keywords": ["NSFW", "GORE", "SEX", "FF:Sailor Moon"] }
        "404":
          description: "No matching keywords found."
          content:
            application/json:
              examples:
                registered:
                  value: { "keywords": [] }
        default:
          description: Default error sample response
components:
  schemas:
    Register:
      required:
        - userName
        - email
        - password
      properties:
        userName:
          type: string
        email:
          type: string
        password:
          type: string
    Login:
      required:
        - name
        - password
      properties:
        name:
          type: string
        password:
          type: string
    Settings:
      properties:
        bio:
          type: string
        publishEmail:
          type: boolean
        darkMode:
          type: boolean
    NewStory:
      required:
        - storyTitle
        - bodyText
      properties:
        storyTitle:
          type: string
        bodyText:
          type: string
    ContinueStory:
      required:
        - entryTitle
        - bodyText
      properties:
        entryTitle:
          type: string
        bodyText:
          type: string
    Message:
      required:
        - messageText
      properties:
        messageText:
          type: string
        name:
          type: string
        email:
          type: string
        useLoginInfo:
          type: boolean
    UpdateMessage:
      properties:
        read:
          type: boolean
    Flag:
      required:
        - reason
      properties:
        reason:
          type: string
